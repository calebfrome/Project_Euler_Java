import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.Scanner;


public class _067_TrianglePathII {

	public static void main(String[] args) throws FileNotFoundException {
		
		Scanner file =  new Scanner(new File("file67.txt"));
		int[] row1 =  new int[1];
		int[] row2 =  new int[2];
		int[] row3 =  new int[3];
		int[] row4 =  new int[4];
		int[] row5 =  new int[5];
		int[] row6 =  new int[6];
		int[] row7 =  new int[7];
		int[] row8 =  new int[8];
		int[] row9 =  new int[9];
		int[] row10 = new int[10];
		int[] row11 = new int[11];
		int[] row12 = new int[12];
		int[] row13 = new int[13];
		int[] row14 = new int[14];
		int[] row15 = new int[15];
		int[] row16 = new int[16];
		int[] row17 = new int[17];
		int[] row18 = new int[18];
		int[] row19 = new int[19];
		int[] row20 = new int[20];
		int[] row21 = new int[21];
		int[] row22 = new int[22];
		int[] row23 = new int[23];
		int[] row24 = new int[24];
		int[] row25 = new int[25];
		int[] row26 = new int[26];
		int[] row27 = new int[27];
		int[] row28 = new int[28];
		int[] row29 = new int[29];
		int[] row30 = new int[30];
		int[] row31 = new int[31];
		int[] row32 = new int[32];
		int[] row33 = new int[33];
		int[] row34 = new int[34];
		int[] row35 = new int[35];
		int[] row36 = new int[36];
		int[] row37 = new int[37];
		int[] row38 = new int[38];
		int[] row39 = new int[39];
		int[] row40 = new int[40];
		int[] row41 = new int[41];
		int[] row42 = new int[42];
		int[] row43 = new int[43];
		int[] row44 = new int[44];
		int[] row45 = new int[45];
		int[] row46 = new int[46];
		int[] row47 = new int[47];
		int[] row48 = new int[48];
		int[] row49 = new int[49];
		int[] row50 = new int[50];
		int[] row51 = new int[51];
		int[] row52 = new int[52];
		int[] row53 = new int[53];
		int[] row54 = new int[54];
		int[] row55 = new int[55];
		int[] row56 = new int[56];
		int[] row57 = new int[57];
		int[] row58 = new int[58];
		int[] row59 = new int[59];
		int[] row60 = new int[60];
		int[] row61 = new int[61];
		int[] row62 = new int[62];
		int[] row63 = new int[63];
		int[] row64 = new int[64];
		int[] row65 = new int[65];
		int[] row66 = new int[66];
		int[] row67 = new int[67];
		int[] row68 = new int[68];
		int[] row69 = new int[69];
		int[] row70 = new int[70];
		int[] row71 = new int[71];
		int[] row72 = new int[72];
		int[] row73 = new int[73];
		int[] row74 = new int[74];
		int[] row75 = new int[75];
		int[] row76 = new int[76];
		int[] row77 = new int[77];
		int[] row78 = new int[78];
		int[] row79 = new int[79];
		int[] row80 = new int[80];
		int[] row81 = new int[81];
		int[] row82 = new int[82];
		int[] row83 = new int[83];
		int[] row84 = new int[84];
		int[] row85 = new int[85];
		int[] row86 = new int[86];
		int[] row87 = new int[87];
		int[] row88 = new int[88];
		int[] row89 = new int[89];
		int[] row90 = new int[90];
		int[] row91 = new int[91];
		int[] row92 = new int[92];
		int[] row93 = new int[93];
		int[] row94 = new int[94];
		int[] row95 = new int[95];
		int[] row96 = new int[96];
		int[] row97 = new int[97];
		int[] row98 = new int[98];
		int[] row99 = new int[99];
		int[] row100 = new int[100];

		
		int[] path1 =  new int[1];
		int[] path2 =  new int[2];
		int[] path3 =  new int[3];
		int[] path4 =  new int[4];
		int[] path5 =  new int[5];
		int[] path6 =  new int[6];
		int[] path7 =  new int[7];
		int[] path8 =  new int[8];
		int[] path9 =  new int[9];
		int[] path10 = new int[10];
		int[] path11 = new int[11];
		int[] path12 = new int[12];
		int[] path13 = new int[13];
		int[] path14 = new int[14];
		int[] path15 = new int[15];
		int[] path16 = new int[16];
		int[] path17 = new int[17];
		int[] path18 = new int[18];
		int[] path19 = new int[19];
		int[] path20 = new int[20];
		int[] path21 = new int[21];
		int[] path22 = new int[22];
		int[] path23 = new int[23];
		int[] path24 = new int[24];
		int[] path25 = new int[25];
		int[] path26 = new int[26];
		int[] path27 = new int[27];
		int[] path28 = new int[28];
		int[] path29 = new int[29];
		int[] path30 = new int[30];
		int[] path31 = new int[31];
		int[] path32 = new int[32];
		int[] path33 = new int[33];
		int[] path34 = new int[34];
		int[] path35 = new int[35];
		int[] path36 = new int[36];
		int[] path37 = new int[37];
		int[] path38 = new int[38];
		int[] path39 = new int[39];
		int[] path40 = new int[40];
		int[] path41 = new int[41];
		int[] path42 = new int[42];
		int[] path43 = new int[43];
		int[] path44 = new int[44];
		int[] path45 = new int[45];
		int[] path46 = new int[46];
		int[] path47 = new int[47];
		int[] path48 = new int[48];
		int[] path49 = new int[49];
		int[] path50 = new int[50];
		int[] path51 = new int[51];
		int[] path52 = new int[52];
		int[] path53 = new int[53];
		int[] path54 = new int[54];
		int[] path55 = new int[55];
		int[] path56 = new int[56];
		int[] path57 = new int[57];
		int[] path58 = new int[58];
		int[] path59 = new int[59];
		int[] path60 = new int[60];
		int[] path61 = new int[61];
		int[] path62 = new int[62];
		int[] path63 = new int[63];
		int[] path64 = new int[64];
		int[] path65 = new int[65];
		int[] path66 = new int[66];
		int[] path67 = new int[67];
		int[] path68 = new int[68];
		int[] path69 = new int[69];
		int[] path70 = new int[70];
		int[] path71 = new int[71];
		int[] path72 = new int[72];
		int[] path73 = new int[73];
		int[] path74 = new int[74];
		int[] path75 = new int[75];
		int[] path76 = new int[76];
		int[] path77 = new int[77];
		int[] path78 = new int[78];
		int[] path79 = new int[79];
		int[] path80 = new int[80];
		int[] path81 = new int[81];
		int[] path82 = new int[82];
		int[] path83 = new int[83];
		int[] path84 = new int[84];
		int[] path85 = new int[85];
		int[] path86 = new int[86];
		int[] path87 = new int[87];
		int[] path88 = new int[88];
		int[] path89 = new int[89];
		int[] path90 = new int[90];
		int[] path91 = new int[91];
		int[] path92 = new int[92];
		int[] path93 = new int[93];
		int[] path94 = new int[94];
		int[] path95 = new int[95];
		int[] path96 = new int[96];
		int[] path97 = new int[97];
		int[] path98 = new int[98];
		int[] path99 = new int[99];
		int[] pathSolution = new int[100];
		pathSolution[0]=1;

		ArrayList<int[]> arrays = new ArrayList<>();
		arrays.add(row1); //0
		arrays.add(path1); //1
		arrays.add(row2);//2
		arrays.add(path2); //3
		arrays.add(row3); //4
		arrays.add(path3);
		arrays.add(row4); //6
		arrays.add(path4);
		arrays.add(row5); //8
		arrays.add(path5);
		arrays.add(row6); //10
		arrays.add(path6);
		arrays.add(row7);
		arrays.add(path7);
		arrays.add(row8);
		arrays.add(path8);
		arrays.add(row9);
		arrays.add(path9);
		arrays.add(row10);
		arrays.add(path10);
		arrays.add(row11); 
		arrays.add(path11);
		arrays.add(row12);
		arrays.add(path12);
		arrays.add(row13);
		arrays.add(path13);
		arrays.add(row14);
		arrays.add(path14);
		arrays.add(row15);
		arrays.add(path15);
		arrays.add(row16);
		arrays.add(path16);
		arrays.add(row17);
		arrays.add(path17);
		arrays.add(row18);
		arrays.add(path18);
		arrays.add(row19);
		arrays.add(path19);
		arrays.add(row20);
		arrays.add(path20);
		arrays.add(row21); 
		arrays.add(path21);
		arrays.add(row22);
		arrays.add(path22);
		arrays.add(row23);
		arrays.add(path23);
		arrays.add(row24);
		arrays.add(path24);
		arrays.add(row25);
		arrays.add(path25);
		arrays.add(row26);
		arrays.add(path26);
		arrays.add(row27);
		arrays.add(path27);
		arrays.add(row28);
		arrays.add(path28);
		arrays.add(row29);
		arrays.add(path29);
		arrays.add(row30);
		arrays.add(path30);
		arrays.add(row31); 
		arrays.add(path31);
		arrays.add(row32);
		arrays.add(path32);
		arrays.add(row33);
		arrays.add(path33);
		arrays.add(row34);
		arrays.add(path34);
		arrays.add(row35);
		arrays.add(path35);
		arrays.add(row36);
		arrays.add(path36);
		arrays.add(row37);
		arrays.add(path37);
		arrays.add(row38);
		arrays.add(path38);
		arrays.add(row39);
		arrays.add(path39);
		arrays.add(row40);
		arrays.add(path40);
		arrays.add(row41); 
		arrays.add(path41);
		arrays.add(row42);
		arrays.add(path42);
		arrays.add(row43);
		arrays.add(path43);
		arrays.add(row44);
		arrays.add(path44);
		arrays.add(row45);
		arrays.add(path45);
		arrays.add(row46);
		arrays.add(path46);
		arrays.add(row47);
		arrays.add(path47);
		arrays.add(row48);
		arrays.add(path48);
		arrays.add(row49);
		arrays.add(path49);
		arrays.add(row50);
		arrays.add(path50);
		arrays.add(row51); 
		arrays.add(path51);
		arrays.add(row52);
		arrays.add(path52);
		arrays.add(row53);
		arrays.add(path53);
		arrays.add(row54);
		arrays.add(path54);
		arrays.add(row55);
		arrays.add(path55);
		arrays.add(row56);
		arrays.add(path56);
		arrays.add(row57);
		arrays.add(path57);
		arrays.add(row58);
		arrays.add(path58);
		arrays.add(row59);
		arrays.add(path59);
		arrays.add(row60);
		arrays.add(path60);
		arrays.add(row61); 
		arrays.add(path61);
		arrays.add(row62);
		arrays.add(path62);
		arrays.add(row63);
		arrays.add(path63);
		arrays.add(row64);
		arrays.add(path64);
		arrays.add(row65);
		arrays.add(path65);
		arrays.add(row66);
		arrays.add(path66);
		arrays.add(row67);
		arrays.add(path67);
		arrays.add(row68);
		arrays.add(path68);
		arrays.add(row69);
		arrays.add(path69);
		arrays.add(row70);
		arrays.add(path70);
		arrays.add(row71); 
		arrays.add(path71);
		arrays.add(row72);
		arrays.add(path72);
		arrays.add(row73);
		arrays.add(path73);
		arrays.add(row74);
		arrays.add(path74);
		arrays.add(row75);
		arrays.add(path75);
		arrays.add(row76);
		arrays.add(path76);
		arrays.add(row77);
		arrays.add(path77);
		arrays.add(row78);
		arrays.add(path78);
		arrays.add(row79);
		arrays.add(path79);
		arrays.add(row80);
		arrays.add(path80);
		arrays.add(row81); 
		arrays.add(path81);
		arrays.add(row82);
		arrays.add(path82);
		arrays.add(row83);
		arrays.add(path83);
		arrays.add(row84);
		arrays.add(path84);
		arrays.add(row85);
		arrays.add(path85);
		arrays.add(row86);
		arrays.add(path86);
		arrays.add(row87);
		arrays.add(path87);
		arrays.add(row88);
		arrays.add(path88);
		arrays.add(row89);
		arrays.add(path89);
		arrays.add(row90);
		arrays.add(path90);
		arrays.add(row91); 
		arrays.add(path91);
		arrays.add(row92);
		arrays.add(path92);
		arrays.add(row93);
		arrays.add(path93);
		arrays.add(row94);
		arrays.add(path94);
		arrays.add(row95);
		arrays.add(path95);
		arrays.add(row96);
		arrays.add(path96);
		arrays.add(row97);
		arrays.add(path97);
		arrays.add(row98);
		arrays.add(path98);
		arrays.add(row99);
		arrays.add(path99);
		arrays.add(row100);
		arrays.add(pathSolution);
		
		//read shit in
		for(int readRow=0;readRow<100;readRow++) {
			for(int pos=0;pos<readRow+1;pos++) {
				arrays.get(2*readRow)[pos]=file.nextInt();
				System.out.println("row "+readRow+" pos "+pos);
			}
		}
		while(file.hasNext())
			System.out.println(file.nextInt());
		
		for(int i=99;i>0;i--) {
			for(int j=0;j<i;j++) {
				if(sumFromRowPos(arrays,i+1,j+1,false)>sumFromRowPos(arrays,i+1,j+2,false))
					arrays.get(2*i-1)[j]=j+1;
				else
					arrays.get(2*i-1)[j]=j+2;
			}
		}
		
		for(int i=1;i<100;i++) {
			pathSolution[i] = arrays.get(2*i-1)[pathSolution[i-1]-1];
		}
		printArray(pathSolution);
		
		//calculate overall sum based on pathSolution
		int sum=0;
		for(int i=0;i<100;i++) {
			sum+=arrays.get(2*i)[pathSolution[i]-1];
		}
		System.out.println(sum);
		System.out.println(sumFromRowPos(arrays,1,1,true));
		
		file.close();
	}
	
	public static int sumFromRowPos(ArrayList<int[]> arrays, int rowStart, int posStart, boolean showSteps) {
		int row = rowStart;
		int oldPos=0;
		int pos = posStart-1;
		int sum = arrays.get(2*row-2)[pos];
		row++;
		while(row<101) {
			if(showSteps)
				System.out.println(sum);
			oldPos=pos;
			pos=arrays.get(2*row-3)[oldPos]-1;
			sum+=arrays.get(2*row-2)[pos];
			row++;
		}
		return sum;
	}
	
	public static void printArray(int[] AL) {
		for(int i:AL)
			System.out.print(i+" ");
		System.out.println();
	}
}